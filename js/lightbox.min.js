console.clear();

// define images
let images = [
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_053', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_053', project: 'buechehof', index: '0', mobileColumn: '4 / 14', mobileRow: '4 / 18', desktopColumn: '4 / 14', desktopRow: '1 / 15' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_050', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_050', project: 'buechehof', index: '1', mobileColumn: '2 / 16', mobileRow: '20 / 30', desktopColumn: '16 / 30', desktopRow: '3 / 13' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_065', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_065', project: 'buechehof', index: '2', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '9 / 23', desktopRow: '27 / 37' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_058', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_058', project: 'buechehof', index: '3', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '16 / 23', desktopRow: '15 / 25' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_046', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_046', project: 'buechehof', index: '4', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '25 / 35', desktopRow: '22 / 29' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_034', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_034', project: 'buechehof', index: '5', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '30 / 44', desktopRow: '31 / 41' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_040', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_040', project: 'buechehof', index: '6', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '2 / 9', desktopRow: '43 / 53' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_012', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_012', project: 'buechehof', index: '7', mobileColumn: '4 / 14', mobileRow: '4 / 18', desktopColumn: '30 / 40', desktopRow: '43 / 57' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_011', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_011', project: 'buechehof', index: '8', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '21 / 28', desktopRow: '49 / 59' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_005', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_005', project: 'buechehof', index: '9', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '16 / 23', desktopRow: '61 / 71' },
    { url: 'assets/buechehof/', src: 'tim_ott_2024_06_werk_1_erlinsbach_000', thumb: 'tim_ott_2024_06_werk_1_erlinsbach_000', project: 'buechehof', index: '10', mobileColumn: '4 / 14', mobileRow: '4 / 18', desktopColumn: '4 / 14', desktopRow: '59 / 73' },
    { url: 'assets/buechehof/', src: 'tim_ott_2023_03_werk_1_erlinsbach_133', thumb: 'tim_ott_2023_03_werk_1_erlinsbach_133', project: 'buechehof', index: '11', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '30 / 44', desktopRow: '78/ 88' },
    { url: 'assets/buechehof/', src: 'tim_ott_2023_03_werk_1_erlinsbach_110', thumb: 'tim_ott_2023_03_werk_1_erlinsbach_110', project: 'buechehof', index: '12', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '32 / 42', desktopRow: '69 / 76' },
    { url: 'assets/buechehof/', src: 'tim_ott_2023_03_werk_1_erlinsbach_220', thumb: 'tim_ott_2023_03_werk_1_erlinsbach_220', project: 'buechehof', index: '13', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '30 / 40', desktopRow: '90 / 97' },
    { url: 'assets/buechehof/', src: 'tim_ott_2023_03_werk_1_erlinsbach_138', thumb: 'tim_ott_2023_03_werk_1_erlinsbach_138', project: 'buechehof', index: '14', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '14 / 28', desktopRow: '92/ 102' },
    { url: 'assets/buechehof/', src: 'tim_ott_2023_03_werk_1_erlinsbach_164', thumb: 'tim_ott_2023_03_werk_1_erlinsbach_164', project: 'buechehof', index: '15', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '2 / 12', desktopRow: '99 / 106' },
    { url: 'assets/buechehof/', src: 'tim_ott_2023_03_werk_1_erlinsbach_148', thumb: 'tim_ott_2023_03_werk_1_erlinsbach_148', project: 'buechehof', index: '16', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '32 / 42', desktopRow: '104 / 111' },
    { url: 'assets/buechehof/', src: 'tim_ott_2023_03_werk_1_erlinsbach_198', thumb: 'tim_ott_2023_03_werk_1_erlinsbach_198', project: 'buechehof', index: '17', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '4 / 18', desktopRow: '108/ 118' },
    { url: 'assets/buechehof/', src: 'tim_ott_2023_03_werk_1_erlinsbach_218', thumb: 'tim_ott_2023_03_werk_1_erlinsbach_218', project: 'buechehof', index: '18', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '4 / 14', desktopRow: '120 / 127' },

    { url: 'assets/wartenbergstrasse/', src: 'tim_ott_2024_09_hsa_wartenbergstrasse_068', thumb: 'tim_ott_2024_09_hsa_wartenbergstrasse_068', project: 'wartenbergstrasse', index: '0', mobileColumn: '4 / 14', mobileRow: '4 / 18', desktopColumn: '32 / 42', desktopRow: '1 / 15' },
    { url: 'assets/wartenbergstrasse/', src: 'tim_ott_2024_09_hsa_wartenbergstrasse_052c', thumb: 'tim_ott_2024_09_hsa_wartenbergstrasse_052c', project: 'wartenbergstrasse', index: '1', mobileColumn: '2 / 16', mobileRow: '20 / 30', desktopColumn: '16 / 30', desktopRow: '3 / 13' },
    { url: 'assets/wartenbergstrasse/', src: 'tim_ott_2024_09_hsa_wartenbergstrasse_061', thumb: 'tim_ott_2024_09_hsa_wartenbergstrasse_061', project: 'wartenbergstrasse', index: '2', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '23 / 30', desktopRow: '15 / 25' },
    { url: 'assets/wartenbergstrasse/', src: 'tim_ott_2024_09_hsa_wartenbergstrasse_040', thumb: 'tim_ott_2024_09_hsa_wartenbergstrasse_040', project: 'wartenbergstrasse', index: '3', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '23 / 37', desktopRow: '27 / 37' },
    { url: 'assets/wartenbergstrasse/', src: 'tim_ott_2024_09_hsa_wartenbergstrasse_051', thumb: 'tim_ott_2024_09_hsa_wartenbergstrasse_051', project: 'wartenbergstrasse', index: '4', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '11 / 21', desktopRow: '22 / 29' },
    { url: 'assets/wartenbergstrasse/', src: 'tim_ott_2024_09_hsa_wartenbergstrasse_048', thumb: 'tim_ott_2024_09_hsa_wartenbergstrasse_048', project: 'wartenbergstrasse', index: '5', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '3 / 17', desktopRow: '31 / 41' },
    { url: 'assets/wartenbergstrasse/', src: 'tim_ott_2024_09_hsa_wartenbergstrasse_008', thumb: 'tim_ott_2024_09_hsa_wartenbergstrasse_008', project: 'wartenbergstrasse', index: '6', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '36 / 43', desktopRow: '43 / 53' },
    { url: 'assets/wartenbergstrasse/', src: 'tim_ott_2024_09_hsa_wartenbergstrasse_016', thumb: 'tim_ott_2024_09_hsa_wartenbergstrasse_016', project: 'wartenbergstrasse', index: '7', mobileColumn: '4 / 14', mobileRow: '4 / 18', desktopColumn: '7 / 17', desktopRow: '43 / 57' },
    { url: 'assets/wartenbergstrasse/', src: 'tim_ott_2024_09_hsa_wartenbergstrasse_021', thumb: 'tim_ott_2024_09_hsa_wartenbergstrasse_021', project: 'wartenbergstrasse', index: '8', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '19 / 26', desktopRow: '49 / 59' },

// BUG: CACHE HIDDEN IMAGES TO NOT CAUSE WHITEOUT OR PREVIOUS GALLERY SHOWING UP ON NEW GALLERY OPEN, ENGRISH LMFAO

    { url: 'assets/oubliettes/', src: 'asset_003', project: 'oubliettes', index: '0' },
    { url: 'assets/oubliettes/', src: 'asset_004', project: 'oubliettes', index: '0' },
    { url: 'assets/oubliettes/', src: 'asset_005', project: 'oubliettes', index: '0' },
    { url: 'assets/oubliettes/', src: 'asset_006', thumb: 'asset_006', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '2 / 12', desktopRow: '1 / 8' },
    { url: 'assets/oubliettes/', src: 'asset_007', thumb: 'asset_007_thumb', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '2 / 16', desktopRow: '10 / 20' },
    { url: 'assets/oubliettes/', src: 'asset_008', thumb: 'asset_008_thumb', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '6 / 16', desktopRow: '22 / 29' },
    { url: 'assets/oubliettes/', src: 'asset_009', thumb: 'asset_009', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '20 / 30', desktopRow: '15 / 22' },
    { url: 'assets/oubliettes/', src: 'asset_010', thumb: 'asset_010_thumb', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '32 / 42', desktopRow: '15 / 22' },
    { url: 'assets/oubliettes/', src: 'asset_011', thumb: 'asset_011_thumb', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '18 / 32', desktopRow: '24 / 34' },
    { url: 'assets/oubliettes/', src: 'asset_012', thumb: 'asset_012_thumb', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '4 / 14', desktopRow: '36 / 43' },
    { url: 'assets/oubliettes/', src: 'asset_013', thumb: 'asset_013', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '16 / 26', desktopRow: '36 / 43' },
    { url: 'assets/oubliettes/', src: 'asset_014', thumb: 'asset_014_thumb', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '28 / 42', desktopRow: '38 / 48' },
    { url: 'assets/oubliettes/', src: 'asset_015', thumb: 'asset_015', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '34 / 44', desktopRow: '29/ 36' },
    { url: 'assets/oubliettes/', src: 'asset_016', thumb: 'asset_016', project: 'oubliettes', index: '0', mobileColumn: '2 / 10', mobileRow: '54 / 56', desktopColumn: '32 / 42', desktopRow: '50 / 57' },
    { url: 'assets/oubliettes/', src: 'asset_017', project: 'oubliettes', index: '0' },
    { url: 'assets/oubliettes/', src: 'asset_018', project: 'oubliettes', index: '0' },
    { url: 'assets/oubliettes/', src: 'asset_019', project: 'oubliettes', index: '0' }
]

// append images, load lightbox
window.addEventListener('load', () => {
    loadImages()
})

function loadImages() {
    images.forEach((img) => {
        const lightbox = document.querySelector('.lightbox')
        const lightboxSrc = document.querySelector('.lightboxSrc')
        const lightboxCount = document.querySelector('.lightboxCount')
        const lightboxClose = document.querySelector('.lightboxClose')
        const lightboxPrev = document.querySelector('.lightboxPrev')
        const lightboxNext = document.querySelector('.lightboxNext')

        let imgContainer = document.createElement('div')
        imgContainer.className = 'imgContainer'
        imgContainer.title = '\u00A9 tim ott'
        imgContainer.alt = '\u00A9 tim ott'
        imgContainer.style.backgroundImage = 'url(' + img.url + img.thumb + '.jpg)'
        imgContainer.style.backgroundRepeat = 'round'
        imgContainer.style.backgroundSize = 'cover'
        imgContainer.style.cursor = 'pointer'

        // define device breakpoints in pixels
        let breakpoints = [
            0,
            768
        ]
        defineScreenSize()

        function defineScreenSize() {
            if (window.innerWidth >= breakpoints[0] && window.innerWidth < breakpoints[1]) {
                gridColumn = img.mobileColumn
                gridRow = img.mobileRow
            } else if (window.innerWidth >= breakpoints[1]) {
                gridColumn = img.desktopColumn
                gridRow = img.desktopRow
            }
        }
        imgContainer.style.gridColumn = gridColumn
        imgContainer.style.gridRow = gridRow
        document.body.appendChild(imgContainer)
        document.querySelector('.' + img.project).appendChild(imgContainer)

        // set currentIndex to index value from selected images
        // push images with same project value as selected image to new array
        imgContainer.addEventListener('click', function () {
            let currentIndex = img.index
            let imgSelection = images.filter((selected) => selected.project === img.project)
            let imgSelectionPath = []
            imgSelection.forEach((selectedImage) => {
                imgSelectionPath.push(selectedImage.url + selectedImage.src + '.jpg')
            })

            console.log(imgSelection)
            console.log(imgSelectionPath)
            console.log('current project: ' + img.project)

            // open lightbox with selected image
            lightboxSrc.setAttribute('src', img.url + img.src)
            lightbox.style.display = 'flex'
            lightboxSrc.style.objectFit = 'contain'
            document.body.style.overflow = 'hidden'
            updateImage()

            // updates lightboxCount according to currentIndex
            function updateImage() {
                console.log('current image: ' + imgSelectionPath[currentIndex])
                lightboxSrc.setAttribute('src', imgSelectionPath[currentIndex])
                lightboxCount.textContent = `${parseFloat(currentIndex) + 1} / ${imgSelection.length}`
            }

            // lightbox navigation
            // parseFloat(currentIndex) ensures currentIndex is a number: number = addition (2+5=7) / string = concatenation (2+5=25)
            document.onkeydown = checkKey;
            function checkKey(pressed) {
                if (pressed.keyCode == '37') {
                    cyclePrev();
                } else if (pressed.keyCode == '39') {
                    cycleNext();
                }
            }
            /* AI WRITTEN MORE EFFICIENT, BUT CAUSES DOUBLE PRINT, EVENT LISTENER NOT DELETED?


            document.addEventListener('keydown', checkKey)
            function checkKey(event) {
                switch (event.key) {
                    case 'ArrowLeft':
                        event.preventDefault()
                        cyclePrev()
                        break
                    case 'ArrowRight':
                        event.preventDefault()
                        cycleNext()
                        break
                    case 'Escape':
                        closeLightbox()
                        break
                }
            }
            */

            // addEventListener if none was added
            if (!lightboxClose.hasEventListener) {
                lightboxClose.addEventListener('click', closeLightbox)
                lightboxClose.hasEventListener = true
            }
            if (!lightboxPrev.hasEventListener) {
                lightboxPrev.addEventListener('click', cyclePrev)
                lightboxPrev.hasEventListener = true
            }
            if (!lightboxNext.hasEventListener) {
                lightboxNext.addEventListener('click', cycleNext)
                lightboxNext.hasEventListener = true
            }
            if (!lightbox.hasEventListener) {
                lightbox.addEventListener('click', lightboxClick)
                lightbox.hasEventListener = true
            }
            function cyclePrev() {
                currentIndex = (currentIndex - 1 + imgSelectionPath.length) % imgSelectionPath.length
                updateImage()
            }
            function cycleNext() {
                currentIndex = (currentIndex + 1) % imgSelectionPath.length
                updateImage()
            }
            function lightboxClick(click) {
                if (click.target === lightbox) {
                    closeLightbox()
                    console.log('test')
                }
            }
            function closeLightbox() {
                lightboxClose.removeEventListener('click', closeLightbox)
                lightboxClose.hasEventListener = false
                lightboxPrev.removeEventListener('click', cyclePrev)
                lightboxPrev.hasEventListener = false
                lightboxNext.removeEventListener('click', cycleNext)
                lightboxNext.hasEventListener = false
                lightbox.removeEventListener('click', lightboxClick)
                lightbox.hasEventListener = false
                lightbox.style.display = 'none'
                lightboxSrc.setAttribute('src', '')
                lightboxSrc.style.objectFit = 'cover'
            }
        })
    })
}

/*
window.addEventListener('resize', function () {
    const gridContainer = document.querySelectorAll('.gridContainer')
    gridContainer.forEach(gridContainer => gridContainer.textContent = '')
    loadImages()
})
*/

// prevent arrow scrolling on safari
// needed?
window.addEventListener('keydown', function (e) {
    if (['Space', 'ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].indexOf(e.code) > -1) {
        e.preventDefault()
    }
}, false)