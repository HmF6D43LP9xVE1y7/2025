console.clear();
// define images
let images = [
    { src: 'buechehof_053', thumb: 'buechehof_053', prj: 'buechehof', index: '0', mobileCol: '2 / 12', mobileRow: '1 / 15', desktopCol: '4 / 14', desktopRow: '1 / 15' },
    { src: 'buechehof_050', thumb: 'buechehof_050', prj: 'buechehof', index: '1', mobileCol: '2 / 16', mobileRow: '17 / 27', desktopCol: '16 / 30', desktopRow: '3 / 13' },
    { src: 'buechehof_065', thumb: 'buechehof_065', prj: 'buechehof', index: '2', mobileCol: '2 / 16', mobileRow: '41 / 51', desktopCol: '9 / 23', desktopRow: '27 / 37' },
    { src: 'buechehof_058', thumb: 'buechehof_058', prj: 'buechehof', index: '3', mobileCol: '2 / 9', mobileRow: '29 / 39', desktopCol: '16 / 23', desktopRow: '15 / 25' },
    { src: 'buechehof_046', thumb: 'buechehof_046', prj: 'buechehof', index: '4', mobileCol: '2 / 12', mobileRow: '53 / 60', desktopCol: '25 / 35', desktopRow: '22 / 29' },
    { src: 'buechehof_040', thumb: 'buechehof_040', prj: 'buechehof', index: '5', mobileCol: '2 / 9', mobileRow: '74 / 84', desktopCol: '2 / 9', desktopRow: '43 / 53' },
    { src: 'buechehof_034', thumb: 'buechehof_034', prj: 'buechehof', index: '6', mobileCol: '2 / 16', mobileRow: '62 / 72', desktopCol: '30 / 44', desktopRow: '31 / 41' },
    { src: 'buechehof_012', thumb: 'buechehof_012', prj: 'buechehof', index: '7', mobileCol: '2 / 12', mobileRow: '98 / 112', desktopCol: '30 / 40', desktopRow: '43 / 57' },
    { src: 'buechehof_011', thumb: 'buechehof_011', prj: 'buechehof', index: '8', mobileCol: '2 / 9', mobileRow: '86 / 96', desktopCol: '21 / 28', desktopRow: '49 / 59' },
    { src: 'buechehof_005', thumb: 'buechehof_005', prj: 'buechehof', index: '9', mobileCol: '2 / 9', mobileRow: '114 / 124', desktopCol: '16 / 23', desktopRow: '61 / 71' },
    { src: 'buechehof_000', thumb: 'buechehof_000', prj: 'buechehof', index: '10', mobileCol: '2 / 12', mobileRow: '126 / 140', desktopCol: '4 / 14', desktopRow: '59 / 73' },
    { src: 'buechehof_230', thumb: 'buechehof_230', prj: 'buechehof', index: '11', mobileCol: '2 / 12', mobileRow: '142 / 149', desktopCol: '32 / 42', desktopRow: '69 / 76' },
    { src: 'buechehof_133', thumb: 'buechehof_133', prj: 'buechehof', index: '12', mobileCol: '2 / 16', mobileRow: '151 / 161', desktopCol: '30 / 44', desktopRow: '78/ 88' },
    { src: 'buechehof_220', thumb: 'buechehof_220', prj: 'buechehof', index: '13', mobileCol: '2 / 12', mobileRow: '163 / 170', desktopCol: '30 / 40', desktopRow: '90 / 97' },
    { src: 'buechehof_138', thumb: 'buechehof_138', prj: 'buechehof', index: '14', mobileCol: '2 / 16', mobileRow: '172 / 182', desktopCol: '14 / 28', desktopRow: '92/ 102' },
    { src: 'buechehof_148', thumb: 'buechehof_148', prj: 'buechehof', index: '15', mobileCol: '2 / 12', mobileRow: '184 / 191', desktopCol: '2 / 12', desktopRow: '99 / 106' },
    { src: 'buechehof_198', thumb: 'buechehof_198', prj: 'buechehof', index: '16', mobileCol: '2 / 16', mobileRow: '193 / 203', desktopCol: '4 / 18', desktopRow: '108/ 118' },
    { src: 'buechehof_218', thumb: 'buechehof_218', prj: 'buechehof', index: '17', mobileCol: '2 / 12', mobileRow: '205 / 212', desktopCol: '34 / 44', desktopRow: '104 / 111' },
    { src: 'wartenbergstrasse_068', thumb: 'wartenbergstrasse_068', prj: 'wartenbergstrasse', index: '0', mobileCol: '2 / 12', mobileRow: '1 / 15', desktopCol: '32 / 42', desktopRow: '1 / 15' },
    { src: 'wartenbergstrasse_052c', thumb: 'wartenbergstrasse_052c', prj: 'wartenbergstrasse', index: '1', mobileCol: '2 / 16', mobileRow: '17 / 27', desktopCol: '16 / 30', desktopRow: '3 / 13' },
    { src: 'wartenbergstrasse_061', thumb: 'wartenbergstrasse_061', prj: 'wartenbergstrasse', index: '2', mobileCol: '2 / 9', mobileRow: '29 / 39', desktopCol: '23 / 30', desktopRow: '15 / 25' },
    { src: 'wartenbergstrasse_051', thumb: 'wartenbergstrasse_051', prj: 'wartenbergstrasse', index: '3', mobileCol: '2 / 12', mobileRow: '41 / 48', desktopCol: '11 / 21', desktopRow: '22 / 29' },
    { src: 'wartenbergstrasse_048', thumb: 'wartenbergstrasse_048', prj: 'wartenbergstrasse', index: '4', mobileCol: '2 / 16', mobileRow: '50 / 60', desktopCol: '3 / 17', desktopRow: '31 / 41' },
    { src: 'wartenbergstrasse_040', thumb: 'wartenbergstrasse_040', prj: 'wartenbergstrasse', index: '5', mobileCol: '2 / 12', mobileRow: '62 / 69', desktopCol: '23 / 37', desktopRow: '27 / 37' },
    { src: 'wartenbergstrasse_016', thumb: 'wartenbergstrasse_016', prj: 'wartenbergstrasse', index: '6', mobileCol: '2 / 12', mobileRow: '71 / 85', desktopCol: '7 / 17', desktopRow: '43 / 57' },
    { src: 'wartenbergstrasse_021', thumb: 'wartenbergstrasse_021', prj: 'wartenbergstrasse', index: '7', mobileCol: '2 / 9', mobileRow: '87 / 97', desktopCol: '19 / 26', desktopRow: '49 / 59' },
    { src: 'wartenbergstrasse_008', thumb: 'wartenbergstrasse_008', prj: 'wartenbergstrasse', index: '8', mobileCol: '2 / 9', mobileRow: '99 / 109', desktopCol: '36 / 43', desktopRow: '43 / 53' },
    { src: 'oubliettes_003', prj: 'oubliettes', index: '0' },
    { src: 'oubliettes_004', prj: 'oubliettes', index: '0' },
    { src: 'oubliettes_005', prj: 'oubliettes', index: '0' },
    { src: 'oubliettes_006', thumb: 'oubliettes_006', prj: 'oubliettes', index: '0', mobileCol: '4 / 14', mobileRow: '1 / 8', desktopCol: '2 / 12', desktopRow: '1 / 8' }, // custom mobile thumbnails
    { src: 'oubliettes_007', thumb: 'oubliettes_007_thumb', prj: 'oubliettes', index: '0', mobileCol: '2 / 16', mobileRow: '10 / 20', desktopCol: '2 / 16', desktopRow: '10 / 20' },  // custom mobile thumbnails
    { src: 'oubliettes_008', thumb: 'oubliettes_008_thumb', prj: 'oubliettes', index: '0', mobileCol: '6 / 16', mobileRow: '22 / 29', desktopCol: '6 / 16', desktopRow: '22 / 29' },  // custom mobile thumbnails
    { src: 'oubliettes_009', thumb: 'oubliettes_009', prj: 'oubliettes', index: '0', mobileCol: '2 / 12', mobileRow: '31 / 38', desktopCol: '20 / 30', desktopRow: '15 / 22' },  // custom mobile thumbnails
    { src: 'oubliettes_010', thumb: 'oubliettes_010_thumb', prj: 'oubliettes', index: '0', mobileCol: '4 / 14', mobileRow: '40 / 47', desktopCol: '32 / 42', desktopRow: '15 / 22' },  // custom mobile thumbnails
    { src: 'oubliettes_011', thumb: 'oubliettes_011_thumb', prj: 'oubliettes', index: '0', mobileCol: '2 / 16', mobileRow: '49 / 59', desktopCol: '18 / 32', desktopRow: '24 / 34' },  // custom mobile thumbnails
    { src: 'oubliettes_015', thumb: 'oubliettes_015', prj: 'oubliettes', index: '0', mobileCol: '2 / 12', mobileRow: '61 / 68', desktopCol: '34 / 44', desktopRow: '29/ 36' },  // custom mobile thumbnails
    { src: 'oubliettes_012', thumb: 'oubliettes_012_thumb', prj: 'oubliettes', index: '0', mobileCol: '6 / 16', mobileRow: '70 / 77', desktopCol: '4 / 14', desktopRow: '36 / 43' },  // custom mobile thumbnails
    { src: 'oubliettes_013', thumb: 'oubliettes_013', prj: 'oubliettes', index: '0', mobileCol: '4 / 14', mobileRow: '79 / 86', desktopCol: '16 / 26', desktopRow: '36 / 43' },  // custom mobile thumbnails
    { src: 'oubliettes_014', thumb: 'oubliettes_014_thumb', prj: 'oubliettes', index: '0', mobileCol: '2 / 16', mobileRow: '88 / 98', desktopCol: '28 / 42', desktopRow: '38 / 48' },  // custom mobile thumbnails
    { src: 'oubliettes_016', thumb: 'oubliettes_016', prj: 'oubliettes', index: '0', mobileCol: '4 / 14', mobileRow: '100 / 107', desktopCol: '32 / 42', desktopRow: '50 / 57' },  // custom mobile thumbnails
    { src: 'oubliettes_017', prj: 'oubliettes', index: '0' },
    { src: 'oubliettes_018', prj: 'oubliettes', index: '0' },
    { src: 'oubliettes_019', prj: 'oubliettes', index: '0' },
    { src: 'gartenweg_025', thumb: 'gartenweg_025', prj: 'gartenweg', index: '0', mobileCol: '2 / 12', mobileRow: '1 / 15', desktopCol: '34 / 44', desktopRow: '1 / 15' },
    { src: 'gartenweg_040', thumb: 'gartenweg_040', prj: 'gartenweg', index: '1', mobileCol: '2 / 16', mobileRow: '17 / 27', desktopCol: '18 / 32', desktopRow: '15 / 25' },
    { src: 'gartenweg_030', thumb: 'gartenweg_030', prj: 'gartenweg', index: '2', mobileCol: '2 / 9', mobileRow: '29 / 39', desktopCol: '25 / 32', desktopRow: '3 / 13' },
    { src: 'gartenweg_017', thumb: 'gartenweg_017', prj: 'gartenweg', index: '3', mobileCol: '2 / 9', mobileRow: '41 / 51', desktopCol: '9 / 16', desktopRow: '13 / 23' },
    { src: 'gartenweg_007', thumb: 'gartenweg_007', prj: 'gartenweg', index: '4', mobileCol: '2 / 12', mobileRow: '53 / 67', desktopCol: '2 / 12', desktopRow: '25 / 39' },
    { src: 'gartenweg_070', thumb: 'gartenweg_070', prj: 'gartenweg', index: '5', mobileCol: '2 / 16', mobileRow: '69 / 79', desktopCol: '4 / 18', desktopRow: '41 / 51' },
    { src: 'gartenweg_075', thumb: 'gartenweg_075', prj: 'gartenweg', index: '6', mobileCol: '2 / 12', mobileRow: '81 / 88', desktopCol: '20 / 30', desktopRow: '36 / 43' },
    { src: 'gartenweg_057', thumb: 'gartenweg_057', prj: 'gartenweg', index: '7', mobileCol: '2 / 12', mobileRow: '90 / 104', desktopCol: '20 / 30', desktopRow: '49 / 63' },
    { src: 'gartenweg_043', thumb: 'gartenweg_043', prj: 'gartenweg', index: '8', mobileCol: '2 / 9', mobileRow: '106 / 116', desktopCol: '11 / 18', desktopRow: '57 / 67' },
    { src: 'gartenweg_102', thumb: 'gartenweg_102', prj: 'gartenweg', index: '9', mobileCol: '2 / 12', mobileRow: '118 / 125', desktopCol: '28 / 38', desktopRow: '65 / 72' },
    { src: 'gartenweg_023', thumb: 'gartenweg_023', prj: 'gartenweg', index: '10', mobileCol: '2 / 12', mobileRow: '127 / 134', desktopCol: '34 / 44', desktopRow: '74 / 81' },
    { src: 'gartenweg_061', thumb: 'gartenweg_061', prj: 'gartenweg', index: '11', mobileCol: '2 / 16', mobileRow: '136 / 146', desktopCol: '18 / 32', desktopRow: '76/ 86' },
    { src: 'gartenweg_052', thumb: 'gartenweg_052', prj: 'gartenweg', index: '12', mobileCol: '2 / 12', mobileRow: '148 / 155', desktopCol: '22 / 32', desktopRow: '88 / 95' },
    { src: 'gartenweg_004', thumb: 'gartenweg_004', prj: 'gartenweg', index: '13', mobileCol: '2 / 12', mobileRow: '157 / 164', desktopCol: '2 / 12', desktopRow: '88 / 95' },
    { src: 'gartenweg_018', thumb: 'gartenweg_018', prj: 'gartenweg', index: '14', mobileCol: '2 / 12', mobileRow: '166 / 173', desktopCol: '18 / 28', desktopRow: '97 / 104' },
    { src: 'gartenweg_055', thumb: 'gartenweg_055', prj: 'gartenweg', index: '15', mobileCol: '2 / 16', mobileRow: '175 / 185', desktopCol: '30 / 44', desktopRow: '99/ 109' }
]
// append images on load
window.addEventListener('load', loadImages);
// append images on resize
let resizeTimeout;
const debounce = (func, delay) => {
    return (...args) => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
            func.apply(this, args);
        }, delay);
    };
};
const handleResize = debounce(() => {
    const gridContainer = document.querySelectorAll('.gridContainer');
    gridContainer.forEach(gridContainer => gridContainer.textContent = '');
    loadImages();
}, 100);
window.addEventListener('resize', handleResize);
// append images
function loadImages() {
    images.forEach((img) => {
        const arrowLeft = 37;
        const arrowRight = 39;
        const lb = document.querySelector('.lightbox');
        const lbSrc = document.querySelector('.lightboxSrc');
        const lbCount = document.querySelector('.lightboxCount');
        const lbClose = document.querySelector('.lightboxClose');
        const lbPrev = document.querySelector('.lightboxPrev');
        const lbNext = document.querySelector('.lightboxNext');
        const imgContainer = document.createElement('div');
        imgContainer.className = 'imgContainer';
        imgContainer.title = '\u00A9 tim ott';
        imgContainer.alt = '\u00A9 tim ott';
        imgContainer.style.backgroundImage = `url(assets/${img.prj}/${img.thumb}.jpg)`;
        imgContainer.style.backgroundRepeat = 'round';
        imgContainer.style.backgroundSize = 'cover';
        imgContainer.style.cursor = 'pointer';
        // define device breakpoints in pixels
        const breakpoints = [0, 767.9];
        const isMobile = window.innerWidth < breakpoints[1];
        imgContainer.style.gridColumn = isMobile ? img.mobileCol : img.desktopCol;
        imgContainer.style.gridRow = isMobile ? img.mobileRow : img.desktopRow;
        document.querySelector(`.${img.prj}`).appendChild(imgContainer);
        // set currentIndex to index value from selected images
        // push images with same project value as selected image to new array

        // CONTINUE AI COMPARE HERE

        imgContainer.addEventListener('click', function () {
            let currentIndex = img.index;
            let imgSelection = images.filter((selected) => selected.prj === img.prj);
            let imgSelectionPath = [];
            imgSelection.forEach((selectedImage) => {
                imgSelectionPath.push(`assets/${selectedImage.prj}/${selectedImage.src}.jpg`);
            });
            console.log(imgSelection);
            console.log(imgSelectionPath);
            console.log('current project: ' + img.prj);
            // open lightbox with selected image
            updateImage();
            lb.style.display = 'flex';
            lbSrc.style.objectFit = 'contain';
            document.body.style.overflow = 'hidden';
            // updates lightboxCount according to currentIndex
            function updateImage() {
                console.log('current image: ' + imgSelectionPath[currentIndex]);
                lbSrc.setAttribute('src', imgSelectionPath[currentIndex]);
                lbCount.textContent = `${parseFloat(currentIndex) + 1} / ${imgSelection.length}`;
            }
            // lightbox navigation
            document.onkeydown = checkKey;
            function checkKey(pressed) {
                if (pressed.keyCode == arrowLeft) {
                    cyclePrev();
                } else if (pressed.keyCode == arrowRight) {
                    cycleNext();
                }
            }
            /* AI WRITTEN MORE EFFICIENT, BUT CAUSES DOUBLE PRINT, EVENT LISTENER NOT DELETED?
            document.addEventListener('keydown', checkKey)
            function checkKey(event) {
                switch (event.key) {
                    case 'ArrowLeft':
                        event.preventDefault()
                        cyclePrev()
                        break
                    case 'ArrowRight':
                        event.preventDefault()
                        cycleNext()
                        break
                    case 'Escape':
                        closeLightbox()
                        break
                }
            }
            */
            // addEventListener if none was added
            if (!lbClose.hasEventListener) {
                lbClose.addEventListener('click', closeLightbox);
                lbClose.hasEventListener = true;
            }
            if (!lbPrev.hasEventListener) {
                lbPrev.addEventListener('click', cyclePrev);
                lbPrev.hasEventListener = true;
            }
            if (!lbNext.hasEventListener) {
                lbNext.addEventListener('click', cycleNext);
                lbNext.hasEventListener = true;
            }
            if (!lb.hasEventListener) {
                lb.addEventListener('click', lightboxClick);
                lb.hasEventListener = true;
            }
            function cyclePrev() {
                currentIndex = (parseFloat(currentIndex) - 1 + imgSelectionPath.length) % imgSelectionPath.length;
                updateImage();
            }
            function cycleNext() {
                currentIndex = (parseFloat(currentIndex) + 1) % imgSelectionPath.length;
                updateImage();
            }
            function lightboxClick(click) {
                if (click.target === lb) {
                    closeLightbox();
                    console.log('test');
                }
            }
            function closeLightbox() {
                lbClose.removeEventListener('click', closeLightbox);
                lbClose.hasEventListener = false;
                lbPrev.removeEventListener('click', cyclePrev);
                lbPrev.hasEventListener = false;
                lbNext.removeEventListener('click', cycleNext);
                lbNext.hasEventListener = false;
                lb.removeEventListener('click', lightboxClick);
                lb.hasEventListener = false;
                lb.style.display = 'none';
                lbSrc.style.objectFit = 'cover';
                lbSrc.setAttribute('src', '');
            }
        });
    });
}

// AI WRITTEN FOLLOWS, to compare
/*

imgContainer.addEventListener('click', () => {
            openLightbox(img);
        });




function openLightbox(selectedImg) {
        const imgSelection = images.filter(img => img.project === selectedImg.project);
        const imgSelectionPath = imgSelection.map(img => `${img.url}${img.src}.jpg`);

        let currentIndex = selectedImg.index;

        function updateImage() {
            lightboxSrc.setAttribute('src', imgSelectionPath[currentIndex]);
            lightboxCount.textContent = `${currentIndex + 1} / ${imgSelection.length}`;
        }

        function cyclePrev() {
            currentIndex = (currentIndex - 1 + imgSelectionPath.length) % imgSelectionPath.length;
            updateImage();
        }

        function cycleNext() {
            currentIndex = (currentIndex + 1) % imgSelectionPath.length;
            updateImage();
        }

        function closeLightbox() {
            lightbox.style.display = 'none';
            lightboxSrc.setAttribute('src', '');
            document.body.style.overflow = 'auto';
            removeEventListeners();
        }

        function removeEventListeners() {
            document.removeEventListener('keydown', handleKeydown);
            lightboxClose.removeEventListener('click', closeLightbox);
            lightboxPrev.removeEventListener('click', cyclePrev);
            lightboxNext.removeEventListener('click', cycleNext);
        }

        function handleKeydown(event) {
            if (event.keyCode === LEFT_ARROW_KEY) {
                cyclePrev();
            } else if (event.keyCode === RIGHT_ARROW_KEY) {
                cycleNext();
            } else if (event.key === 'Escape') {
                closeLightbox();
            }
        }

        document.addEventListener('keydown', handleKeydown);
        lightboxClose.addEventListener('click', closeLightbox);
        lightboxPrev.addEventListener('click', cyclePrev);
        lightboxNext.addEventListener('click', cycleNext);
        lightbox.style.display = 'flex';
        document.body.style.overflow = 'hidden';
        updateImage();
    }

*/

// preventDefault, mainly disables scrolling on safari while lightbox is open
window.addEventListener('keydown', function (e) {
    if (['Space', 'ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].indexOf(e.code) > -1) {
        e.preventDefault();
    }
}, false);